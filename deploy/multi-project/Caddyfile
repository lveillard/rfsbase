# Multi-Project Caddyfile
# Add new project blocks as needed
# Caddy automatically provisions SSL certificates

{
    email admin@yourdomain.com
}

# ===========================================
# RFSbase (rfsbase.com)
# ===========================================
rfsbase.com {
    reverse_proxy rfsbase-web:3000
    encode gzip
}

api.rfsbase.com {
    reverse_proxy rfsbase-api:3001
    encode gzip

    header {
        Access-Control-Allow-Origin "https://rfsbase.com"
        Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Access-Control-Allow-Headers "Content-Type, Authorization"
    }
}

# ===========================================
# Example: Another Project (example.com)
# ===========================================
# example.com {
#     reverse_proxy example-web:3000
#     encode gzip
# }
#
# api.example.com {
#     reverse_proxy example-api:4000
#     encode gzip
# }

# ===========================================
# IP-based access (no SSL) - for testing
# Use when you don't have domains configured yet
# ===========================================
:80 {
    # Route based on path or host header
    @rfsbase host rfsbase.localhost
    handle @rfsbase {
        reverse_proxy rfsbase-web:3000
    }

    # Default: show available projects
    handle {
        respond "Multi-project server. Configure your domain or use project.localhost"
    }
}
